# name: benchmark/micro/csv/read.benchmark
# description: Run CSV auto-detection on the lineitem CSV
# group: [csv]

name CSV Read Benchmark on S3
group csv

require httpfs

run
SELECT
    sum(l_extendedprice * l_discount) AS revenue
FROM
    "s3://pedro-s3-csv/lineitem.csv"
WHERE
    l_shipdate >= CAST('1994-01-01' AS date)
    AND l_shipdate < CAST('1995-01-01' AS date)
    AND l_discount BETWEEN 0.05
    AND 0.07
    AND l_quantity < 24;